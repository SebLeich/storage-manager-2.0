<div class="body">

    <app-process-builder style="flex: 1; overflow: hidden;"></app-process-builder>

    <div class="control-footer">

        <mat-form-field class="mat-form-field-outline-white-bg mat-form-field-no-padding" appearance="outline">
            <mat-label>current draft (total: {{(service.models$|async)?.length ?? 0}})</mat-label>
            <mat-select [value]="service.currentIBpmnJSModelGuid$|async">
                <mat-select-trigger>
                    <div #element class="editable-select-trigger" contenteditable (click)="$event.stopPropagation()" (keydown.enter)="blurElement(element, $event)" (focusout)="service.renameCurrentModel(element.innerText)">
                        {{(service.currentIBpmnJSModel$|async)?.name ?? 'no name'}}
                    </div>
                </mat-select-trigger>
                <mat-option class="dropdown-option" *ngFor="let model of ((service.models$|async) ?? [])" [value]="model.guid" (click)="service.setModel(model)">
                    <span class="text">
                        {{model.name ?? 'no name'}}
                    </span>
                    <mat-icon class="icon">edit</mat-icon>
                    <mat-icon class="icon danger" (click)="service.removeModel(model)">delete_forever</mat-icon>
                </mat-option>
                <mat-option class="dropdown-interaction-control" (click)="service.createModel()">
                    Add new draft
                </mat-option>
            </mat-select>
        </mat-form-field>

        <div class="spacer"></div>

        <div class="control-footer-item" (click)="service.saveModel()">
            <mat-icon>save</mat-icon>
        </div>

    </div>

    <div class="control-wrapper" style="display: none;">

        <div class="option-wrapper">

            <div class="headline" (click)="toggleModules()">
                <span class="text">Models</span>
                <span class="counter">
                    {{(service.models$|async).length}}
                </span>
            </div>

            <div [@showList]="(service.models$|async).length" *ngIf="modelsVisible$|async">

                <div class="quick-interaction-wrapper">

                    <app-method-quick-interaction></app-method-quick-interaction>
                    
                </div>

            </div>

        </div>

        <div class="option-wrapper">

            <div class="headline" (click)="toggleMethods()">
                <span class="text">Functions</span>
                <span class="counter">
                    {{(service.funcs$|async).length}}
                </span>
            </div>

            <div [@showList]="(service.funcs$|async).length" *ngIf="methodsVisible$|async">

                <div class="option" *ngFor="let func of (service.funcs$|async)">

                    <div class="text">{{func.name ?? 'unnamed function'}}</div>
                    <mat-icon *ngIf="func.customImplementation" (click)="service.removeFunction(func)" class="control" color="warn">delete_forever</mat-icon>

                </div>

            </div>

        </div>

        <div class="option-wrapper">

            <div class="headline" (click)="toggleParams()">
                <span class="text">Params</span>
                <span class="counter">
                    {{(service.params$|async).length}}
                </span>
            </div>

            <div [@showList]="(service.params$|async).length" *ngIf="paramsVisible$|async">

                <div class="option" *ngFor="let param of (service.params$|async)">

                    <div class="text">{{param.name ?? 'unnamed param'}}</div>

                </div>

            </div>

        </div>

    </div>

</div>